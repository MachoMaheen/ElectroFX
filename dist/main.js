(()=>{"use strict";var e={23:e=>{e.exports=require("util")},157:e=>{e.exports=require("electron")},317:e=>{e.exports=require("child_process")},672:function(e,r,t){var i=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t);var s=Object.getOwnPropertyDescriptor(r,t);s&&!("get"in s?!r.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,s)}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),s=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&i(r,e,t);return s(r,e),r};Object.defineProperty(r,"__esModule",{value:!0});const n=t(157),a=o(t(928)),c=o(t(896)),l=o(t(857)),d=t(317),p=(0,t(23).promisify)(d.exec);let u=null;function m(){u=new n.BrowserWindow({width:900,height:700,webPreferences:{nodeIntegration:!1,contextIsolation:!0,preload:a.join(__dirname,"preload.js")}});const e=a.join(__dirname,"index.html");console.log("Current directory:",__dirname),console.log("HTML path:",e),console.log("HTML file exists:",c.existsSync(e)),u.loadFile(e),u.on("closed",(()=>{u=null}))}n.app.whenReady().then((()=>{m(),n.app.on("activate",(()=>{null===u&&m()}))})),n.app.on("window-all-closed",(()=>{"darwin"!==process.platform&&n.app.quit()})),n.ipcMain.handle("test-ipc",(async()=>({success:!0,message:"IPC is working!"}))),n.ipcMain.handle("list-directory",(async(e,r)=>{try{const e=r||l.homedir();console.log("Listing directory:",e);const t=await c.promises.readdir(e),i=await Promise.all(t.map((async r=>{const t=a.join(e,r);try{const e=await c.promises.stat(t);return{name:r,path:t,isDirectory:e.isDirectory(),size:e.size,created:e.birthtime,modified:e.mtime}}catch(e){return{name:r,path:t,isDirectory:!1,size:0,created:new Date,modified:new Date,error:"Permission denied"}}})));return{path:e,files:i}}catch(e){return console.error("Error listing directory:",e),{error:e.message}}})),n.ipcMain.handle("delete-file",(async(e,r)=>{try{return await c.promises.access(r),(await c.promises.stat(r)).isDirectory()?await c.promises.rmdir(r,{recursive:!0}):await c.promises.unlink(r),{success:!0}}catch(e){return console.error("Error deleting file/directory:",e),"EACCES"===e.code?{error:"Permission denied. This file requires elevated privileges to delete.",requiresElevation:!0}:{error:e.message}}})),n.ipcMain.handle("delete-file-elevated",(async(e,r,t)=>{try{await c.promises.access(r);const e=(await c.promises.stat(r)).isDirectory();if("win32"===process.platform){const t=e?`powershell.exe -Command "Start-Process -Verb RunAs cmd.exe -ArgumentList '/c rd /s /q \\"${r}\\"'"`:`powershell.exe -Command "Start-Process -Verb RunAs cmd.exe -ArgumentList '/c del /f /q \\"${r}\\"'"`;return await p(t),{success:!0}}if("darwin"!==process.platform&&"linux"!==process.platform)return{error:"Elevated permissions not supported on this platform."};{const i=r.replace(/'/g,"'\\''"),s=e?`echo '${t}' | sudo -S rm -rf '${i}'`:`echo '${t}' | sudo -S rm -f '${i}'`;try{return await p(s),{success:!0}}catch(e){const r=e.stderr||"";if(r.includes("incorrect password")||r.includes("Sorry, try again"))return{error:"Incorrect password. Please try again."};throw e}}}catch(e){return console.error("Error deleting with elevated privileges:",e),{error:e.message}}})),n.ipcMain.handle("select-directory",(async()=>{if(!u)return{canceled:!0};const e=await n.dialog.showOpenDialog(u,{properties:["openDirectory"]});return!e.canceled&&e.filePaths.length>0?{path:e.filePaths[0]}:{canceled:!0}}))},857:e=>{e.exports=require("os")},896:e=>{e.exports=require("fs")},928:e=>{e.exports=require("path")}},r={};!function t(i){var s=r[i];if(void 0!==s)return s.exports;var o=r[i]={exports:{}};return e[i].call(o.exports,o,o.exports,t),o.exports}(672)})();